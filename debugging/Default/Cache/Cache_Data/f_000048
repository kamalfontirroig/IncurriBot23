"use strict";(self.webpackChunkppm=self.webpackChunkppm||[]).push([[7728],{27506:(A,S,e)=>{e.r(S),e.d(S,{BigPictureWbsIssueWidgetModule:()=>Qt});var E=e(59025),T=e(68269),x=e(62320),p=e(12938),g=e(25642),c=e(85873),v=e(8164),l=e(28693),r=e(72254),m=e(40946),d=e(64362),a=e(55331),t=e(84046),u=e(70335),h=e(92945),i=e(43786),f=e(25468),D=e(26799),O=e(77062),P=e(58296),L=e(64865),xe=e(68319),ye=e(89251),Ee=e(5789),_=e(57260),Te=e(88485),Se=e(70190),Ie=e(96633),ee=e(4218),te=e(41619),De=e(58910),Oe=e(72876),oe=e(77099),Re=e(4738),U=e(18019),V=e(64993),F=e(53339),b=e(98274),K=e(63833),J=e(71726),Me=e(95336),Ae=e(32498),se=e(80361),Pe=e(94003),Be=e(99429),Le=e(83950),ie=e(2196),re=e(25673),We=e(21548),$=e(15843),j=function(s,C,o,n){var R,y=arguments.length,I=y<3?C:null===n?n=Object.getOwnPropertyDescriptor(C,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)I=Reflect.decorate(s,C,o,n);else for(var M=s.length-1;M>=0;M--)(R=s[M])&&(I=(y<3?R(I):y>3?R(C,o,I):R(C,o))||I);return y>3&&I&&Object.defineProperty(C,o,I),I},H=function(s,C){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(s,C)};class W{constructor(C,o,n,y,I,R,M,w,z,G){this.actions$=C,this.wbsService=o,this.environmentService=n,this.boxAggregateCommandService=y,this.boxHierarchyService=I,this.boxQueryConverter=R,this.boxLocalStorageService=M,this.userProfileDataRepository=w,this.issueIdProvider=z,this.applicationFeaturesStorage=G,this.initState$=this.actions$.pipe((0,i.l4)(U.wN.INIT_STATE),(0,b.w)(B=>(0,F.of)(new oe.RG(B.wbsId)))),this.setWbsToOverview$=this.actions$.pipe((0,i.l4)(oe.bk.FETCH_CONFIGURATION_SUCCESS),(0,b.w)(B=>(0,F.of)(new U.Ny(B.wbsId)))),this.setActiveBox$=this.actions$.pipe((0,i.l4)(U.wN.SET_ACTIVE_BOX),(0,b.w)(B=>this.userProfileDataRepository.getUserData().pipe((0,K.q)(1),(0,b.w)(N=>{const Y=N.id,q=this.boxLocalStorageService.getBoxId(Y).map(Q=>this.boxHierarchyService.selectBoxWithHierarchy(Q)).orElseGet(()=>this.boxHierarchyService.selectRootBoxWithHierarchy());return this.loadBoxes(),q.pipe((0,K.q)(1),(0,J.U)(Q=>({box:Q,userId:Y})))}),(0,b.w)(N=>this.selectActiveBoxAction$(N.box,N.userId,B))))),this.fetchTasksForActiveProgram$=this.actions$.pipe((0,i.l4)(U.wN.SET_PROGRAM),(0,b.w)(B=>this.wbsService.getFetchParams(B.wbsId).pipe((0,b.w)(N=>(0,F.of)(new Re.Uy(B.wbsId,N))))))}loadBoxes(){const C=new De.P,o=this.issueIdProvider.get(),n=this.environmentService.getMainExtPlatformId(),y=new Ae.j(o,Me.U.REGULAR_ISSUE,n);C.setExtTaskId(y),this.boxAggregateCommandService.setRequestSpecification(C),this.boxAggregateCommandService.load()}selectActiveBoxAction$(C,o,n){if(!C){const R=this.applicationFeaturesStorage.getFeatures().getWbsWidgetConfiguration(),M={errorType:V.N.INFO,infoMessage:R.getBoxUnExistErrorMessage().toString(),actionType:n.type};return(0,F.of)(new U.zn(n.wbsId,M))}const y=C.getData().getId();if(this.boxLocalStorageService.setBoxId(o,y),!C){const R=document.getElementById("sp-wbs-circle-loader");return R&&R.parentElement.removeChild(R),(0,F.of)(new U.zn(n.wbsId,{errorType:V.N.INFO,infoMessage:"The issue has not been synced to the scope of any Box yet or you need additional permissions to access it.",actionType:n.type}))}let I=this.boxHierarchyService.getBoxById(y);if(!I||!I.isAvailable()){const R=C.toFlat(!0);if(I=this.boxQueryConverter.fromQueryNode(R.find(M=>M.getData().isAvailable())).get(),!I)return(0,F.of)(new U.zn(n.wbsId,{errorType:V.N.INFO,infoMessage:"The WBS is not visible, as you do not have appropriate permissions to view associated Boxes.",actionType:n.type}))}return(0,F.of)(new U.Nl(n.wbsId,I))}}W.\u0275fac=function(C){return new(C||W)(t.LFG(i.eX),t.LFG(Be.B),t.LFG(Le.L),t.LFG(ie.N),t.LFG(re.T),t.LFG(Oe.R),t.LFG(Pe.Y),t.LFG(se.z),t.LFG(We.w),t.LFG($.x))},W.\u0275prov=t.Yz7({token:W,factory:W.\u0275fac}),j([(0,i.Qm)(),H("design:type",Object)],W.prototype,"initState$",void 0),j([(0,i.Qm)(),H("design:type",Object)],W.prototype,"setWbsToOverview$",void 0),j([(0,i.Qm)(),H("design:type",Object)],W.prototype,"setActiveBox$",void 0),j([(0,i.Qm)(),H("design:type",Object)],W.prototype,"fetchTasksForActiveProgram$",void 0);var Fe=e(45635),be=e(59694),ne=e(85431),ae=e(45432),Z=e(71079),le=e(81785),Ue=e(23110);let Ne=(()=>{class s extends be.C{constructor(o,n,y,I,R,M){super(o,n,y,I),this.wbsRepository=R,this.wbs=M}addColumn$(o){return super.addColumn$(o).pipe((0,Fe.b)(()=>{this.wbsRepository.reFetchTasks(this.wbs.getWbsId())}))}}return s.\u0275fac=function(o){return new(o||s)(t.LFG(ne.h),t.LFG(le.X),t.LFG(ae.L),t.LFG(Z.J),t.LFG(Ue.n),t.LFG(_.F))},s.\u0275prov=t.Yz7({token:s,factory:s.\u0275fac}),s})();e(11206);var _e=e(63187),Ve=e(50292),X=e(62546),we=e(81622);let ce=(()=>{class s extends X.H{constructor(o,n,y,I,R,M){super(o,n),this.changeDetectorRef=y,this.boxHierarchyService=I,this.applicationFeatures=R,this.document=M,this.boxChange=new t.vpe,this.SELECT_BOX_ID="wbs-box-switcher"}ngOnInit(){this.setConfiguration(),this.setSelectBoxConfiguration(),this.resolveSetBodyCssClasses()}onBoxChange(o){const n=this.boxHierarchyService.getBoxById(o);!n.isAvailable()||this.boxChange.emit(n)}getHostClasses(){return["sp-block"]}resolveSetBodyCssClasses(){const o=this.configuration.getBodyCssClasses();o&&o.length>0&&this.domManipulator.addClass(this.document.body,...o)}setConfiguration(){this.configuration=this.applicationFeatures.getFeatures().getWbsWidgetConfiguration()}setSelectBoxConfiguration(){var o,n;const y=(new _e.L.Builder).withShowDropdownOpenIndicator(!1).withDropdownLayout(Ve.A.MEDIUM).withShowFavouriteColumn(!1).withDropdownTriggerCssClass("sp-text-base").withDestroyDropdownAfterSelect(!0),I=this.configuration.getBoxDropdownConfig();I&&y.withDropdownMinWidth(null!==(o=I.width)&&void 0!==o?o:s.DEFAULT_SELECT_BOX_DROPDOWN_WIDTH).withDropdownMinHeight(null!==(n=I.height)&&void 0!==n?n:s.DEFAULT_SELECT_BOX_DROPDOWN_HEIGHT),this.selectBoxConfig=y.build()}}return s.DEFAULT_SELECT_BOX_DROPDOWN_WIDTH=540,s.DEFAULT_SELECT_BOX_DROPDOWN_HEIGHT=300,s.\u0275fac=function(o){return new(o||s)(t.Y36(t.SBq),t.Y36(t.Qsj),t.Y36(t.sBO),t.Y36(re.T),t.Y36($.x),t.Y36(a.K0))},s.\u0275cmp=t.Xpm({type:s,selectors:[["sp-wbs-box-switcher"]],inputs:{contextBoxId:"contextBoxId"},outputs:{boxChange:"boxChange"},features:[t.qOj],decls:1,vars:3,consts:[[1,"wbs-select-box","sp-h-8",3,"selectId","selectedBoxId","config","selectedBoxIdChange"]],template:function(o,n){1&o&&(t.TgZ(0,"sp-select-box",0),t.NdJ("selectedBoxIdChange",function(I){return n.onBoxChange(I)}),t.qZA()),2&o&&t.Q6J("selectId",n.SELECT_BOX_ID)("selectedBoxId",n.contextBoxId)("config",n.selectBoxConfig)},directives:[we.N],styles:[".wbs-select-box{max-width:300px}.wbs-select-box .sp-select-box-trigger.dropdown-open{background:var(--blue-50)}.wbs-select-box .sp-select-box-trigger{background-color:var(--gray-20);color:var(--gray-400);padding:var(--space-x2) var(--space-x3)}.wbs-select-box .sp-select-box-trigger .sp-select-box-trigger__box-name{font-size:var(--font-size-m)}\n"],encapsulation:2,changeDetection:0}),s})();var de=e(17314),ze=e(42348),ue=e(91771),Ge=e(10703),Qe=e(29186),Ke=e(17483),je=e(25069),He=e(73790),Ye=e(81503),Je=e(30684),$e=e(674),Ze=e(53950),pe=e(92574),Xe=e(47285),ke=e(73455),qe=e(26463);function et(s,C){if(1&s&&(t.TgZ(0,"a",9),t._UZ(1,"i",10),t.TgZ(2,"span",11),t._uU(3,"Show on Gantt"),t.qZA(),t.qZA()),2&s){const o=t.oxw();t.Q6J("spNavigationLink",o.ganttUrl())}}function tt(s,C){if(1&s&&(t.ynx(0),t.TgZ(1,"a",12),t._UZ(2,"i",13),t.qZA(),t.BQk()),2&s){const o=t.oxw();t.xp6(1),t.Q6J("spNavigationLink",o.goToWbsWidgetConfiguration())}}let me=(()=>{class s extends X.H{constructor(o,n,y,I,R,M,w,z,G,B){super(o,n),this.wbs=y,this.navigationLinkService=I,this.changeDetectorRef=R,this.permissionService=M,this.columnViewCommandService=w,this.userProfileDataRepository=z,this.applicationFeatures=G,this.window=B,this.availableColumns=[],this.changeExpand=new t.vpe,this.nodeExpanded=new t.vpe}ngOnInit(){this.setTreeConfiguration(),this.setIsNavigationAvailable(),this.observeTreeExpandNode(),this.observeUserData(),this.setAdminState()}onBoxChange(o,n){const y=this.userData.id;n&&n.clearExpandedNodeIndex(),this.wbs.changeBox(y,o),this.columnViewCommandService.fetchAll()}ganttUrl(){const o=this.navigationLinkService.goToGantt(this.box.getId().toString());return o.href?o.href:o}goToWbsWidgetConfiguration(){const o=this.navigationLinkService.goToWbsWidgetConfiguration(this.box.getId().toString());return o.href?o.href:o}getHostClasses(){return["sp-relative","sp-h-full","sp-cursor-default","sp-flex","sp-flex-col","sp-pb-4"]}setIsNavigationAvailable(){this.isNavigationAvailable=this.applicationFeatures.getFeatures().isWbsWidgetNavigationAvailable()}observeUserData(){this.userProfileDataRepository.getUserData().pipe(this.takeUntilDestroy()).subscribe(o=>{this.userData=o})}setAdminState(){this.isAdmin=this.permissionService.isPluginAdmin()}observeTreeExpandNode(){this.treeActions$.ofTreeAction(ue.MF.EXPAND_NODE).pipe(this.takeUntilDestroy()).subscribe(o=>{this.nodeExpanded.emit(o.payload)})}setTreeConfiguration(){const o=$e.p.default().withEnabled(!0).withAggregations(!0).withDistributes(!0),y=Ke.t.default().withViewPortRender(!0).withAdditionalTasksOnViewport(50),I=Ze.h.default().withEnabled(!0).withDialogPositionMargin(0);this.config=Qe.Z.default().withColumnHeaders(!0).withChildrenField("children").withDynamicCreate(!1).withNodesExpandedAtStart(!0).withCompareMarkedNodes((R,M)=>!!R.id&&M===R.id).withIsDisabled(R=>void 0!==R.accessible&&!R.accessible).withExpandedStoredInLS(!1).withPerspectiveManager(I).withColumnSelectorConfig(o).withColumnDragAndDrop(!0).withViewportRender(y).withTreeRowHierarchyStrategy(Je.N.CHEVRON_WITH_LINES).withColumnResize(!0).withContentScroll(!0)}observeTreeActions(){this.treeActions$.ofTreeAction(ue.MF.EXPAND_NODE).pipe(this.takeUntilDestroy()).subscribe(o=>{this.nodeExpanded.emit(o.payload)})}}return s.\u0275fac=function(o){return new(o||s)(t.Y36(t.SBq),t.Y36(t.Qsj),t.Y36(_.F),t.Y36(ke.M),t.Y36(t.sBO),t.Y36(Xe.$),t.Y36(Z.J),t.Y36(se.z),t.Y36($.x),t.Y36(de.m))},s.\u0275cmp=t.Xpm({type:s,selectors:[["sp-issue-details-treegrid"]],viewQuery:function(o,n){if(1&o&&t.Gf(pe.l,7,Ge.e),2&o){let y;t.iGM(y=t.CRH())&&(n.treeActions$=y.first)}},inputs:{id:"id",box:"box",nodes:"nodes",availableColumns:"availableColumns"},outputs:{changeExpand:"changeExpand",nodeExpanded:"nodeExpanded"},features:[t._Bn([{provide:Ye.o,useValue:He.c.VIEW},{provide:je.H,useClass:ze.x}]),t.qOj],decls:9,vars:7,consts:[["id","sp-message-bar"],[1,"sp-flex","sp-items-end","sp-justify-between","sp-mb-2"],[1,"sp-flex","sp-items-center"],[1,"sp-mr-2",3,"contextBoxId","boxChange"],["class","sp-btn","id","sp-show-on-gantt-button","target","_blank",3,"spNavigationLink",4,"ngIf"],[4,"ngIf"],[1,"sp-overflow-hidden"],[1,"sp-flex-auto",3,"treeId","config","nodes","availableColumns"],["treeRef",""],["id","sp-show-on-gantt-button","target","_blank",1,"sp-btn",3,"spNavigationLink"],[1,"fas","fa-stream"],[1,"sp-pl-1"],["target","_blank","id","sp-wrench-button",1,"sp-btn",3,"spNavigationLink"],[1,"fa","fa-wrench"]],template:function(o,n){if(1&o){const y=t.EpF();t._UZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"div",2),t.TgZ(3,"sp-wbs-box-switcher",3),t.NdJ("boxChange",function(R){t.CHM(y);const M=t.MAs(8);return n.onBoxChange(R,M.tree)}),t.qZA(),t.YNc(4,et,4,1,"a",4),t.qZA(),t.YNc(5,tt,3,1,"ng-container",5),t.qZA(),t.TgZ(6,"div",6),t._UZ(7,"sp-treegrid",7,8),t.qZA()}2&o&&(t.xp6(3),t.Q6J("contextBoxId",n.box.getId()),t.xp6(1),t.Q6J("ngIf",n.isNavigationAvailable),t.xp6(1),t.Q6J("ngIf",n.isAdmin&&n.isNavigationAvailable),t.xp6(2),t.Q6J("treeId","wbs-issue-details")("config",n.config)("nodes",n.nodes)("availableColumns",n.availableColumns))},directives:[ce,a.O5,pe.l,qe.k],encapsulation:2,changeDetection:0}),s})();var ot=e(70162),st=e(4662),it=e(52591),rt=e(67890),nt=e(44059),at=e(58754);let lt=(()=>{class s extends nt.H{constructor(o,n,y,I,R){super(o,n,y,I),this.wbs=R}addColumn(o){const n=o.getColumnsFromCollection();if(0===n.length)return(0,F.of)(!1);const y=n[n.length-1],I=y.name,R=y.origin.id,M=o.getId();return this.columnViewCommandService.addFieldToWorkingAreaAndWait(M,I,R,!1).pipe((0,b.w)(()=>this.columnViewQueryService.selectActual().pipe((0,at.h)(!1))),(0,K.q)(1))}addColumn$(o){const n=o.getColumnsFromCollection(),y=n[n.length-1].name,I=n[n.length-1].origin.id,R=o.getId();return this.columnViewCommandService.addFieldToWorkingAreaAndWait(R,y,I,!1).pipe((0,b.w)(()=>this.columnViewQueryService.selectActual()),(0,K.q)(1)).subscribe(M=>{this.wbs.fetchTasksWithFields(M.fieldConfigs)}),(0,F.of)(!1)}}return s.\u0275fac=function(o){return new(o||s)(t.LFG(ne.h),t.LFG(le.X),t.LFG(ae.L),t.LFG(Z.J),t.LFG(_.F))},s.\u0275prov=t.Yz7({token:s,factory:s.\u0275fac}),s})();var ct=e(95442),dt=e(48058),k=e(8163),ut=e(70204),ge=e(75962),pt=e(66706),mt=e(31703),gt=e(95376),vt=e(3963),ve=e(53534);const ht=["treeGridContainer"];function ft(s,C){if(1&s){const o=t.EpF();t.TgZ(0,"div",3,4),t.TgZ(2,"sp-issue-details-treegrid",5),t.NdJ("changeExpand",function(y){return t.CHM(o),t.oxw(2).onChangeExpand(y)})("nodeExpanded",function(y){return t.CHM(o),t.oxw(2).onNodeExpand(y)}),t.qZA(),t._UZ(3,"sp-widget-resizer",6),t.qZA()}if(2&s){const o=t.oxw(2);t.xp6(2),t.Q6J("id",o.wbs.getWbsId())("box",o.box)("nodes",o.nodes)("availableColumns",o.availableColumns),t.xp6(1),t.Q6J("LOCAL_STORAGE_HEIGHT","wbsContentHeight")("MAX_HEIGHT",1500)("MIN_HEIGHT",350)}}function Ct(s,C){if(1&s&&(t.ynx(0),t.YNc(1,ft,4,7,"div",2),t.BQk()),2&s){const o=t.oxw();t.xp6(1),t.Q6J("ngIf",o.dataFetched)}}function xt(s,C){if(1&s&&(t.TgZ(0,"div",9),t.TgZ(1,"p"),t._uU(2),t.qZA(),t.qZA()),2&s){const o=t.oxw(2);t.xp6(2),t.hij(" ",o.error.infoMessage," ")}}function yt(s,C){if(1&s&&(t.TgZ(0,"p"),t._uU(1),t.qZA()),2&s){const o=t.oxw(3);t.xp6(1),t.hij(" ",o.error.infoMessage," ")}}function Et(s,C){if(1&s&&(t.TgZ(0,"p"),t._uU(1),t.qZA()),2&s){const o=t.oxw(3);t.xp6(1),t.hij(" ",o.error.restResponse," ")}}function Tt(s,C){if(1&s&&(t.TgZ(0,"p"),t._uU(1),t.qZA()),2&s){const o=t.oxw(3);t.xp6(1),t.AsE(" ",o.error.restResponse.error.code," - ",o.error.restResponse.error.description," ")}}function St(s,C){if(1&s&&(t.TgZ(0,"div",10),t.YNc(1,yt,2,1,"p",11),t.YNc(2,Et,2,1,"p",11),t.YNc(3,Tt,2,2,"p",11),t.qZA()),2&s){const o=t.oxw(2);t.xp6(1),t.Q6J("ngIf",o.error.infoMessage),t.xp6(1),t.Q6J("ngIf",!o.error.restResponse.error),t.xp6(1),t.Q6J("ngIf",o.error.restResponse.error)}}function It(s,C){if(1&s&&(t.YNc(0,xt,3,1,"div",7),t.YNc(1,St,4,3,"div",8)),2&s){const o=t.oxw();t.Q6J("ngIf",o.error.errorType===o.errorType.INFO),t.xp6(1),t.Q6J("ngIf",o.error.errorType===o.errorType.ERROR)}}let he=(()=>{class s extends X.H{constructor(o,n,y,I,R,M,w,z,G,B,N,Y,q,Q,Kt,jt){super(o,n),this.wbs=y,this.changeDetectorRef=I,this.columnViewModuleCode=R,this.columnViewInitCommandService=M,this.fieldConfigQueryService=w,this.fieldConfigQueryConverter=z,this.boxAggregateCommandService=G,this.fieldCollectionFactory=B,this.applicationInitStorage=N,this.applicationAttributesRepository=Y,this.fieldValueRepository=q,this.document=Q,this.window=Kt,this.clickNotifierService=jt,this.nodes=[],this.dataFetched=!1,this.taskFetching=!1,this.availableColumns=[],this.errorType={INFO:V.N.INFO,ERROR:V.N.ERROR},this.wbs.connectToStore(),this.wbs.initStore()}ngOnInit(){this.applicationAttributesRepository.setDisableColorThemeStatus(!0),this.applicationAttributesRepository.setDisableAccentUserColorStatus(!0),this.resolveInitClickNotifier(),this.boxAggregateCommandService.init(),this.setContextBox(),this.domManipulator.addClass(this.window.document.documentElement,"sp-overflow-hidden"),this.fieldConfigQueryService.selectAllAvailable().pipe((0,J.U)(o=>this.fieldConfigQueryConverter.toTreeColumnAnemia(o)),this.takeUntilDestroy()).subscribe(o=>{this.availableColumns=o}),this.wbsReadySubscription=this.wbs.isDataFetched().pipe(this.takeUntilDestroy()).subscribe(o=>{this.dataFetched=o,this.removeLoader(),this.changeDetectorRef.detectChanges()}),this.treeSubscription=this.wbs.fetchTree().pipe(this.takeUntilDestroy()).subscribe(o=>{this.nodes=ot.cloneDeep(o),this.setFieldValueRepository(),this.changeDetectorRef.detectChanges()}),this.wbs.getTasksState().pipe(this.takeUntilDestroy()).subscribe(o=>{this.taskFetching=o.fetching,this.changeDetectorRef.detectChanges()}),this.issueSubscription=this.wbs.watchWbsState().pipe(this.takeUntilDestroy()).subscribe(o=>{this.box=o.activeBox,this.box&&(this.boxAggregateCommandService.setContextBox(this.box.getId()),this.columnViewModuleCode.setCode(L.I.WBS_EXTERNAL_TASK_PANEL),this.columnViewInitCommandService.initColumnView()),this.setErrorState(o.error),this.removeLoader(),this.changeDetectorRef.detectChanges()}),this.userSettingsSubscription=this.wbs.getUserSettings().pipe(this.takeUntilDestroy()).subscribe(o=>{this.userSettings=o,this.changeDetectorRef.detectChanges()})}ngAfterViewInit(){this.setApplicationInitialized()}finalize(){this.wbs.destroy()}onNodeExpand(o){this.wbs.fetchNodesChildren(o)}onChangeExpand(o){o?this.wbs.expand():this.wbs.collapse()}getHostClasses(){return["sp-block","sp-h-full"]}setApplicationInitialized(){this.applicationInitStorage.set(!0)}setContextBox(){this.boxAggregateCommandService.setContextBox(rt.Au.ROOT_ID)}resolveInitClickNotifier(){this.clickNotifierService&&this.clickNotifierService.init()}removeLoader(){const o=this.document.getElementById("sp-wbs-circle-loader");if(!o)return;const n=this.document.querySelector(".sp-wbs-circle-loader-container");this.domManipulator.addClass(n,"loaded"),o.remove()}setErrorState(o){this.error=o,this.error&&console.warn(this.error)}setFieldValueRepository(){this.fieldValueRepository.setEntities(this.flatTasks(this.nodes).map(o=>new ut.J(o.id,this.fieldCollectionFactory.fromRaw(o.columns),!0,o.accessible,o.data.columnsEditability)))}flatTasks(o){const n=[...o];for(const y of o)n.push(...this.flatTasks(y.children));return n}}return s.\u0275fac=function(o){return new(o||s)(t.Y36(t.SBq),t.Y36(t.Qsj),t.Y36(_.F),t.Y36(t.sBO),t.Y36(pt.L),t.Y36(ct.i),t.Y36(mt.C),t.Y36(gt.y),t.Y36(ie.N),t.Y36(dt.b),t.Y36(it.x),t.Y36(st.t),t.Y36(k.Q),t.Y36(a.K0),t.Y36(de.m),t.Y36(vt.f,8))},s.\u0275cmp=t.Xpm({type:s,selectors:[["sp-wbs-issue-details"]],viewQuery:function(o,n){if(1&o&&t.Gf(ht,5),2&o){let y;t.iGM(y=t.CRH())&&(n.treeGridContainer=y.first)}},features:[t._Bn([{provide:ge.t,useClass:lt}]),t.qOj],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["errorTemplate",""],["class","sp-wbs-grid-content sp-block sp-h-full",4,"ngIf"],[1,"sp-wbs-grid-content","sp-block","sp-h-full"],["treeGridContainer",""],[3,"id","box","nodes","availableColumns","changeExpand","nodeExpanded"],[3,"LOCAL_STORAGE_HEIGHT","MAX_HEIGHT","MIN_HEIGHT"],["class","sp-message sp-message-info sp-w-full sp-h-full sp-flex sp-items-center sp-justify-center",4,"ngIf"],["class","sp-message sp-message-error sp-w-full sp-h-full sp-flex sp-items-center sp-justify-center",4,"ngIf"],[1,"sp-message","sp-message-info","sp-w-full","sp-h-full","sp-flex","sp-items-center","sp-justify-center"],[1,"sp-message","sp-message-error","sp-w-full","sp-h-full","sp-flex","sp-items-center","sp-justify-center"],[4,"ngIf"]],template:function(o,n){if(1&o&&(t.YNc(0,Ct,2,1,"ng-container",0),t.YNc(1,It,2,2,"ng-template",null,1,t.W1O)),2&o){const y=t.MAs(2);t.Q6J("ngIf",!n.error)("ngIfElse",y)}},directives:[a.O5,me,ve.V],styles:[".sp-wbs-grid-content.wait{color:var(--blue-primary)}.sp-message{position:relative;max-width:100%;right:auto;top:auto}\n"],encapsulation:2,changeDetection:0}),s})();var Dt=e(97809),Ot=e(96105);let Rt=(()=>{class s extends k.Q{constructor(){super(...arguments),this.entityIdToEntity=new Map,this.changes$=new Dt.t(1)}setEntities(o){for(const n of o)this.entityIdToEntity.set(n.id,n);this.changes$.next()}selectEntity$(o){return this.changes$.pipe((0,J.U)(()=>this.entityIdToEntity.get(o)),(0,Ot.x)())}}return s.\u0275fac=function(){let C;return function(n){return(C||(C=t.n5z(s)))(n||s)}}(),s.\u0275prov=t.Yz7({token:s,factory:s.\u0275fac}),s})();var Mt=e(71055),At=e(30293),Pt=e(28579),Bt=e(51545),Lt=e(51805),Wt=e(84974),Ft=e(55928),bt=e(62807),Ut=e(1261),Nt=e(68890);let _t=(()=>{class s{canActivate(){return this.isDevMode()}isDevMode(){return"development"===process.env.ENV}}return s.\u0275fac=function(o){return new(o||s)},s.\u0275prov=t.Yz7({token:s,factory:s.\u0275fac}),s})();var Vt=e(60960);const fe="WBS_ISSUE_DETAIL",Ce=new t.OlP("WBS_ISSUE_DETAIL_REDUCER"),wt=s=>s.create("wbsIssuePage");let zt=(()=>{class s{constructor(o,n){this.injector=o,this.wbsResourceFactory=n,n.setRootInjector(o)}}return s.\u0275fac=function(o){return new(o||s)(t.LFG(t.zs3),t.LFG(ee.A))},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({providers:[{provide:_.F,useFactory:wt,deps:[Te.f]},{provide:te.dj,useValue:fe},Se.k,{provide:"MODULE",useValue:"WBS_EXTERNAL_PANEL"},{provide:ge.t,useClass:Ne},{provide:At.S,useClass:Ie.z},{provide:k.Q,useClass:Rt},{provide:ve.B,useValue:"#wbs-widget"},_t,xe.T,ee.A,{provide:Ce,useFactory:te.QW}],imports:[[a.ez,h.Bz.forChild([{path:"",component:he}]),u.u5,bt.nv.forRoot(),Ft.l,Lt.$,Ee.$.forRoot(L.I.WBS_EXTERNAL_TASK_PANEL),Wt.A.forRoot(),i.sQ.forFeature([W]),Bt.F,P.T,r.d.forChild(ye.T),Mt.a.forCommitStrategy(),Ut.E.forRoot(),O.q,Vt.E,Nt.z8,D.L,Pt.X.forRoute(),f.Aw.forFeature(fe,Ce)]]}),s})();var Gt=e(12624);let Qt=(()=>{class s{constructor(o,n,y){o.init(),n.set(!0),y.set(!0)}}return s.\u0275fac=function(o){return new(o||s)(t.LFG(Gt.E),t.LFG(p.z),t.LFG(g.y))},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({imports:[[T.g.forRoot(),v.X.forChild(),l.z.forChild(),r.d.forBox(m.U,m.U,m.U),d.l,c.$,zt,E.O,x.c]]}),s})()},66408:(A,S,e)=>{e.d(S,{W:()=>T});var E=e(81015);class T{constructor(p,g){this.id=p,this.value=g}static arrayFromDTO(p){return Object.keys(p.mapping).map(g=>new T(g,E.C.of(p.mapping[g])))}getValue(){return this.value}}},81813:(A,S,e)=>{e.d(S,{G:()=>v});var E=e(55331),T=e(69498),x=e(90581),p=e(58535),g=e(65929),c=e(84046);let v=(()=>{class l{}return l.\u0275fac=function(m){return new(m||l)},l.\u0275mod=c.oAB({type:l}),l.\u0275inj=c.cJS({providers:[g.O,T.l,x.E,p.e],imports:[[E.ez]]}),l})()},69498:(A,S,e)=>{e.d(S,{l:()=>l});var E=e(81015),T=e(90581),x=e(71726),p=e(70822),g=e(96105),c=e(84046),v=e(58535);let l=(()=>{class r{constructor(d,a){this.boxIdContextStateService=d,this.boxWithScopeTypeService=a}selectContexts(d){const a=this.getBoxIdsNotExistInState(d);return a.length&&this.boxWithScopeTypeService.fetch(a),this.getContextStates(d)}selectContext(d){return this.isBoxIdNotExistInState(d)&&this.boxWithScopeTypeService.fetch([d]),this.getContextState(d)}isBoxOwnScope(d){return this.selectContext(d).pipe((0,x.U)(a=>a&&a.getValue().equals(E.C.OWN)))}getBoxIdsNotExistInState(d){const a=this.boxIdContextStateService.getContexts().map(t=>t.id);return d.filter(t=>!(a.indexOf(t)>-1))}isBoxIdNotExistInState(d){return!this.boxIdContextStateService.getContexts().map(t=>t.id).includes(d)}getContextStates(d){return this.boxIdContextStateService.getState().pipe((0,p.h)(a=>this.hasAllBoxIds(d,a)),(0,x.U)(a=>this.getSelectedIdsFromState(a,d)),(0,g.x)((a,t)=>a.length!==t.length||a.map(i=>i.getValue().getType()).join()===t.map(i=>i.getValue().getType()).join()))}getContextState(d){return this.boxIdContextStateService.getState().pipe((0,x.U)(a=>{const t=this.getSelectedIdsFromState(a,[d]);return t.length?t[0]:void 0}),(0,p.h)(a=>!!a))}getSelectedIdsFromState(d,a){const t=[];return a.forEach(u=>{const h=d.find(i=>i.id===u);h&&t.push(h)}),t}hasAllBoxIds(d,a){let t=d.length;return a.forEach(u=>{d.forEach(h=>{h===u.id&&t--})}),0===t}}return r.\u0275fac=function(d){return new(d||r)(c.LFG(v.e),c.LFG(T.E))},r.\u0275prov=c.Yz7({token:r,factory:r.\u0275fac}),r})()},65929:(A,S,e)=>{e.d(S,{O:()=>t});var E=e(41085),T=e(17542);class g extends T.M{getClassName(){return"BoxWithScopeTypeDTO"}}!function(u,h,i,f){var P,D=arguments.length,O=D<3?h:null===f?f=Object.getOwnPropertyDescriptor(h,i):f;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)O=Reflect.decorate(u,h,i,f);else for(var L=u.length-1;L>=0;L--)(P=u[L])&&(O=(D<3?P(O):D>3?P(h,i,O):P(h,i))||O);D>3&&O&&Object.defineProperty(h,i,O)}([(0,E.ci)(),function(u,h){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:type",Object)}()],g.prototype,"mapping",void 0);var c=e(66408),v=e(71726),l=e(2421),r=e(83155),m=e(84046),d=e(11531),a=e(83950);let t=(()=>{class u extends r.a{constructor(i,f){super(i),this.environmentService=f,this.progress=!1}fetch(i){return this.get("/bulk?boxIds="+i).pipe((0,l.W)(g),(0,v.U)(f=>c.W.arrayFromDTO(f)))}getRestUrl(i){return this.environmentService.getRestBaseUrl()+"ppm/box/scope/type"+i}}return u.\u0275fac=function(i){return new(i||u)(m.LFG(d.O),m.LFG(a.L))},u.\u0275prov=m.Yz7({token:u,factory:u.\u0275fac}),u})()},90581:(A,S,e)=>{e.d(S,{E:()=>g});class E{constructor(){this.list=[]}push(v){this.list.push(...v)}clean(){this.list=[]}contains(v){return this.list.indexOf(v)>-1}remove(v){this.list.splice(this.list.indexOf(v),1)}get(){return this.list}}var T=e(65929),x=e(84046),p=e(58535);let g=(()=>{class c{constructor(l,r){this.boxIdContextStateService=l,this.boxWithContextResource=r,this.boxContextList=new E}fetch(l){const r=this.getNotExistBoxIdsFromAggregation(l);!r.length||(!1===this.boxWithContextResource.progress&&(this.boxWithContextResource.progress=!0,this.subscribeForBoxContext(r)),this.addBoxIdsToAggregation(r))}subscribeForBoxContext(l){const r=this.boxWithContextResource.fetch(l).subscribe(m=>{l.forEach(d=>this.boxContextList.remove(d)),this.addBoxContextsToState(m),this.boxContextList.get().length?(r.unsubscribe(),this.boxWithContextResource.progress=!1,this.fetch(this.cleanList())):this.boxWithContextResource.progress=!1})}cleanList(){const l=this.boxContextList.get();return this.boxContextList.clean(),l}addBoxContextsToState(l){l.forEach(r=>this.boxIdContextStateService.setContext(r))}addBoxIdsToAggregation(l){l.length&&this.boxContextList.push(l)}getNotExistBoxIdsFromAggregation(l){return l.filter(r=>!this.boxContextList.contains(r))}}return c.\u0275fac=function(l){return new(l||c)(x.LFG(p.e),x.LFG(T.O))},c.\u0275prov=x.Yz7({token:c,factory:c.\u0275fac}),c})()},58535:(A,S,e)=>{e.d(S,{e:()=>x});var E=e(18840),T=e(84046);let x=(()=>{class p{constructor(){this.boxIdToContext=[],this.state$=new E.X([])}isContext(c){return!!this.boxIdToContext.find(v=>v.id===c)}setContext(c){this.boxIdToContext.push(c),this.state$.next(this.boxIdToContext)}getContexts(){return this.boxIdToContext}getContext(c){return this.boxIdToContext.find(v=>v.id===c)}getState(){return this.state$.asObservable()}}return p.\u0275fac=function(c){return new(c||p)},p.\u0275prov=T.Yz7({token:p,factory:p.\u0275fac}),p})()},89554:(A,S,e)=>{e.d(S,{r:()=>x});var E=e(60218),T=e(68319);class x extends E.Q{constructor(g){super(g),this.boxAreTaskViewContextTypeService.set(T.T.BOX)}isViewVisibilityEditAvailable(){return!0}}},71055:(A,S,e)=>{e.d(S,{a:()=>h});var E=e(61104),T=e(16130),x=e(59694),p=e(62236),g=e(44059),c=e(72106),v=e(98223),l=e(78609),r=e(84046);let m=(()=>{class i extends c.v{constructor(D,O){super(D,O)}showSuccessfulCommitMessage(){}}return i.\u0275fac=function(D){return new(D||i)(r.LFG(l.e),r.LFG(v.e))},i.\u0275prov=r.Yz7({token:i,factory:i.\u0275fac}),i})();var d=e(75962),a=e(16599),t=e(25069);const u=[{provide:a.R,useClass:T.R}];let h=(()=>{class i{static forCommitStrategy(){return{ngModule:i,providers:[...u,{provide:t.H,useClass:p.A},{provide:d.t,useClass:x.C},{provide:c.v,useClass:m}]}}static forNoCommitStrategy(){return{ngModule:i,providers:[...u,{provide:t.H,useClass:E.o},{provide:d.t,useClass:g.H}]}}}return i.\u0275fac=function(D){return new(D||i)},i.\u0275mod=r.oAB({type:i}),i.\u0275inj=r.cJS({providers:u}),i})()},62236:(A,S,e)=>{e.d(S,{A:()=>v});var E=e(71079),T=e(61104),x=e(75596),p=e(84046),g=e(92586),c=e(82394);let v=(()=>{class l extends T.o{constructor(m,d,a,t){super(m,d,a,t)}changeAggregation(m,d,a,t){super.getColumnViewCommandService().changeAggregationAndCommit(m,d,a,t)}changeDistribute(m,d,a,t){super.getColumnViewCommandService().changeDistributeAndCommit(m,d,a,t)}changeDisplay(m,d,a){super.getColumnViewCommandService().changeDisplayAndCommit(m,d,a)}}return l.\u0275fac=function(m){return new(m||l)(p.LFG(E.J),p.LFG(g.c),p.LFG(c.F),p.LFG(x.v))},l.\u0275prov=p.Yz7({token:l,factory:l.\u0275fac}),l})()},59694:(A,S,e)=>{e.d(S,{C:()=>t});var E=e(70822),T=e(71726),x=e(63833),p=e(58754),g=e(98274),c=e(85431),v=e(75962),l=e(91771),r=e(45432),m=e(71079),d=e(84046),a=e(81785);let t=(()=>{class u extends v.t{constructor(i,f,D,O){super(),this.treePerspectiveFactory=i,this.columnViewQueryService=f,this.columnViewQueryConverter=D,this.columnViewCommandService=O}selectPerspectives$(){return this.columnViewQueryService.selectActual().pipe((0,E.h)(i=>!!i),(0,T.U)(i=>this.convert(i)))}updatePerspective$(i,f){const D=i.getId();if(f.type===l.MF.CHANGE_COLUMN_ORDER){const O=f.payload.nodeId,P=f.payload.nodeIndex;setTimeout(()=>{this.columnViewCommandService.reorderFieldConfig(O,D,P,!0)})}else if(f.type===l.MF.CHANGE_COLUMN_FLEX_STYLES){const O=f.payload.firstColumn,P=f.payload.secondColumn;this.columnViewCommandService.changeFieldConfigFlex([{fieldConfigId:O.nodeId,columnViewId:D,flex:O.flex},{fieldConfigId:P.nodeId,columnViewId:D,flex:P.flex},!0])}else if(f.type===l.MF.REMOVE_COLUMN){const O=f.payload.nodeId,P=i.getId();this.columnViewCommandService.removeFieldFromWorkingArea(P,O,!0)}return this.columnViewQueryService.selectActual().pipe((0,x.q)(1),(0,p.h)(!1))}addColumn$(i){const f=i.getColumnsFromCollection(),D=f[f.length-1].name,O=f[f.length-1].origin.id,P=i.getId();return this.columnViewCommandService.addFieldToWorkingAreaAndWait(P,D,O,!0).pipe((0,g.w)(()=>this.columnViewQueryService.selectActual().pipe((0,x.q)(1),(0,p.h)(!1))))}equals(i,f){return JSON.stringify(i)===JSON.stringify(f)}convert(i){const f=this.columnViewQueryConverter.fromColumnViewQuery(i);return this.treePerspectiveFactory.fromAnemicArray([f])}}return u.\u0275fac=function(i){return new(i||u)(d.LFG(c.h),d.LFG(a.X),d.LFG(r.L),d.LFG(m.J))},u.\u0275prov=d.Yz7({token:u,factory:u.\u0275fac}),u})()},44059:(A,S,e)=>{e.d(S,{H:()=>d});var E=e(71079),T=e(45432),x=e(53339),p=e(70822),g=e(71726),c=e(91771),v=e(85431),l=e(75962),r=e(84046),m=e(81785);let d=(()=>{class a extends l.t{constructor(u,h,i,f){super(),this.treePerspectiveFactory=u,this.columnViewQueryService=h,this.columnViewQueryConverter=i,this.columnViewCommandService=f}selectPerspectives$(){return this.columnViewQueryService.selectActual().pipe((0,p.h)(u=>!!u),(0,g.U)(u=>this.convert(u)))}updatePerspective$(u,h){const i=u.getId();if(h.type===c.MF.CHANGE_COLUMN_ORDER){const f=h.payload.nodeId,D=h.payload.nodeIndex;setTimeout(()=>{this.columnViewCommandService.reorderFieldConfig(f,i,D,!1)})}else if(h.type===c.MF.CHANGE_COLUMN_FLEX_STYLES){const f=h.payload.firstColumn,D=h.payload.secondColumn;this.columnViewCommandService.changeFieldConfigFlex([{fieldConfigId:f.nodeId,columnViewId:i,flex:f.flex},{fieldConfigId:D.nodeId,columnViewId:i,flex:D.flex},!1])}else h.type===c.MF.REMOVE_COLUMN&&this.columnViewCommandService.removeFieldFromWorkingArea(i,h.payload.nodeId,!1);return(0,x.of)(!1)}addColumn$(u){const h=u.getColumnsFromCollection(),i=h[h.length-1].name,f=h[h.length-1].origin.id,D=u.getId();return this.columnViewCommandService.addFieldToWorkingAreaAndWait(D,i,f,!1).pipe((0,g.U)(()=>!1))}convert(u){const h=this.columnViewQueryConverter.fromColumnViewQuery(u);return this.treePerspectiveFactory.fromAnemicArray([h])}}return a.\u0275fac=function(u){return new(u||a)(r.LFG(v.h),r.LFG(m.X),r.LFG(T.L),r.LFG(E.J))},a.\u0275prov=r.Yz7({token:a,factory:a.\u0275fac}),a})()},47076:(A,S,e)=>{e.d(S,{V:()=>v});var E=e(26032),T=e(69417);class x{constructor(r,m,d,a){this.fieldId=r,this.isAscending=m,this.boxId=d,this.date=a}static fromDto(r){return r&&new x(T.Z.fromNumber(r.taskFieldId),"ASCENDING"===r.order,r.boxId,r.timeStamp)}}var p=e(71726),g=e(84046),c=e(13428);let v=(()=>{class l{constructor(m,d){this.taskOrganizationResource=m,this.taskOrganizationRepository=d}fetchOrganizationForBox(m){this.taskOrganizationResource.getOrganizationForBox(m).pipe((0,p.U)(d=>x.fromDto(d))).subscribe(d=>{this.taskOrganizationRepository.setCurrentOrganization(m,d)})}setOrganizationForBox(m,d,a){this.taskOrganizationResource.organizeTasksForBox(m,d,a).pipe((0,p.U)(t=>x.fromDto(t))).subscribe(t=>{this.taskOrganizationRepository.setCurrentOrganization(m,t)})}setOrganizationForTaskChildren(m,d,a,t){this.taskOrganizationResource.organizeTaskChildren(m,d,a,t).subscribe(()=>{this.taskOrganizationRepository.dispatchOrganizationForNonBoxHasChanged()})}}return l.\u0275fac=function(m){return new(m||l)(g.LFG(E.A),g.LFG(c.J))},l.\u0275prov=g.Yz7({token:l,factory:l.\u0275fac}),l})()},36367:(A,S,e)=>{e.d(S,{P:()=>x});var E=e(84046),T=e(13428);let x=(()=>{class p{constructor(c){this.taskOrganizationRepository=c}selectOrganization(c){return this.taskOrganizationRepository.selectCurrentOrganization(c)}selectOrganizationForNonBoxHasChanged(){return this.taskOrganizationRepository.selectOrganizationForNonBoxHasChanged()}}return p.\u0275fac=function(c){return new(c||p)(E.LFG(T.J))},p.\u0275prov=E.Yz7({token:p,factory:p.\u0275fac}),p})()},68435:(A,S,e)=>{e.d(S,{v:()=>c});var E=e(26032),T=e(13428),x=e(47076),p=e(36367),g=e(84046);let c=(()=>{class v{}return v.\u0275fac=function(r){return new(r||v)},v.\u0275mod=g.oAB({type:v}),v.\u0275inj=g.cJS({providers:[x.V,p.P,E.A,T.J]}),v})()},13428:(A,S,e)=>{e.d(S,{J:()=>g});var E=e(90850),T=e(70822),x=e(71726),p=e(84046);let g=(()=>{class c{constructor(){this.organizationForBox=new Map,this.organizationForBoxChanged$=new E.xQ,this.organizationForNonBoxChanged$=new E.xQ}selectCurrentOrganization(l){return this.organizationForBoxChanged$.pipe((0,T.h)(r=>r===l),(0,x.U)(r=>this.organizationForBox.get(r)))}selectOrganizationForNonBoxHasChanged(){return this.organizationForNonBoxChanged$}setCurrentOrganization(l,r){this.organizationForBox.set(l,r),this.organizationForBoxChanged$.next(l)}dispatchOrganizationForNonBoxHasChanged(){this.organizationForNonBoxChanged$.next()}}return c.\u0275fac=function(l){return new(l||c)},c.\u0275prov=p.Yz7({token:c,factory:c.\u0275fac}),c})()},26032:(A,S,e)=>{e.d(S,{A:()=>t});var E=e(60903),T=e(50870),x=e(17542),p=function(u,h,i,f){var P,D=arguments.length,O=D<3?h:null===f?f=Object.getOwnPropertyDescriptor(h,i):f;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)O=Reflect.decorate(u,h,i,f);else for(var L=u.length-1;L>=0;L--)(P=u[L])&&(O=(D<3?P(O):D>3?P(h,i,O):P(h,i))||O);return D>3&&O&&Object.defineProperty(h,i,O),O},g=function(u,h){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(u,h)};class c extends x.M{getClassName(){return"BoxOrganizationDTO"}}p([(0,E.qA)(),g("design:type",Number)],c.prototype,"taskFieldId",void 0),p([(0,T.XV)(),g("design:type",String)],c.prototype,"order",void 0),p([(0,T.XV)(),g("design:type",String)],c.prototype,"boxId",void 0),p([(0,E.qA)(),g("design:type",Number)],c.prototype,"timeStamp",void 0);var v=e(2421),l=e(70822),r=e(83155),m=e(84046),d=e(11531),a=e(83950);let t=(()=>{class u extends r.a{constructor(i,f){super(i),this.environmentService=f}getOrganizationForBox(i){return this.get(`${i}/lastSorted`).pipe((0,l.h)(f=>!!f),(0,v.W)(c))}organizeTasksForBox(i,f,D){const O={fieldId:f.toString(),order:D};return this.put(`${i}/sortAll`,O).pipe((0,v.W)(c))}organizeTaskChildren(i,f,D,O){const P={fieldId:f.toString(),order:D,parentTaskId:O};return this.put(`${i}/sortChildren`,P).pipe((0,v.W)(c))}getRestUrl(i){return this.environmentService.getRestBaseUrl()+`ppm/boxarea-task/sort/box/${i}`}}return u.\u0275fac=function(i){return new(i||u)(m.LFG(d.O),m.LFG(a.L))},u.\u0275prov=m.Yz7({token:u,factory:u.\u0275fac}),u})()},95181:(A,S,e)=>{e.d(S,{G:()=>r});var E=e(63833),T=e(79014),x=e(41711),p=e(62628),g=e(84046),c=e(95881),v=e(57409),l=e(23140);let r=(()=>{class m extends p.b{constructor(a,t,u,h){super(),this.queryLanguageParser=a,this.searchResource=t,this.jqlAutocompleteService=u,this.jqlAutocompleteDataStorageService=h}create(){return this.observeAutocompleteData(),new x.m("","JQL","Jira Software (JQL)","Search by JQL...",{begin:a=>{this.jqlAutocompleteDataStorageService.select().pipe((0,E.q)(1)).subscribe(t=>{this.jqlAutocompleteService.init(a,"sp-query-type-switcher",t),this.jqlAutocompleteService.enable(a)})},end:a=>{this.jqlAutocompleteService.disable(a)}},a=>(this.queryLanguageParser.parse(a),!this.queryLanguageParser.getParseError()),this.queryLanguageParser.getEmitOnInvalidPossible())}observeAutocompleteData(){this.searchResource.getAutocompleteData().pipe(this.takeUntilDestroy()).subscribe(a=>{this.queryLanguageParser.setAutoCompleteData(a.reservedWords)})}}return m.\u0275fac=function(a){return new(a||m)(g.LFG(c.O),g.LFG(v.Z),g.LFG(l.x),g.LFG(T.p))},m.\u0275prov=g.Yz7({token:m,factory:m.\u0275fac}),m})()},79014:(A,S,e)=>{e.d(S,{p:()=>c});var E=e(27609),T=e(71726),x=e(34323),p=e(84046),g=e(27583);let c=(()=>{class v extends E.V{constructor(r){super(),this.searchResource=r,this.isFetched=!1}get(){throw new Error("This storage contains lazy loaded values. Use select method instead.")}select(){return this.isFetched||this.fetch(),super.select()}fetch(){this.searchResource.getAutocompleteData().pipe((0,T.U)(x.k.toDomain)).subscribe(r=>{this.set(r),this.isFetched=!0})}}return v.\u0275fac=function(r){return new(r||v)(p.LFG(g.x))},v.\u0275prov=p.Yz7({token:v,factory:v.\u0275fac}),v})()},39181:(A,S,e)=>{e.d(S,{q:()=>x});var E=e(27609),T=e(84046);let x=(()=>{class p extends E.V{constructor(){super()}}return p.\u0275fac=function(c){return new(c||p)},p.\u0275prov=T.Yz7({token:p,factory:p.\u0275fac}),p})()},90320:(A,S,e)=>{e.d(S,{t:()=>t});var E=e(55331),T=e(70335),x=e(41001),p=e(79047),g=e(74647),c=e(97425),v=e(68890),l=e(26566),r=e(39181),m=e(79014),d=e(95181),a=e(84046);let t=(()=>{class u{}return u.\u0275fac=function(i){return new(i||u)},u.\u0275mod=a.oAB({type:u}),u.\u0275inj=a.cJS({providers:[r.q,m.p,d.G],imports:[[g.w,E.ez,p.C,T.UX,v.z8,c.o,x.J,l.n]]}),u})()},34323:(A,S,e)=>{e.d(S,{k:()=>v});var E=e(77816),T=e(50870);class x{constructor(r,m,d){this.jqlReservedWords=r,this.visibleFieldNames=m,this.visibleFunctionNames=d}}var p=e(17542),g=function(l,r,m,d){var u,a=arguments.length,t=a<3?r:null===d?d=Object.getOwnPropertyDescriptor(r,m):d;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)t=Reflect.decorate(l,r,m,d);else for(var h=l.length-1;h>=0;h--)(u=l[h])&&(t=(a<3?u(t):a>3?u(r,m,t):u(r,m))||t);return a>3&&t&&Object.defineProperty(r,m,t),t},c=function(l,r){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(l,r)};class v extends p.M{static toDomain(r){return new x(r.jqlReservedWords,r.visibleFieldNames,r.visibleFunctionNames)}getClassName(){return"JQLAutocompleteDataDTO"}}g([(0,E.Yl)(),(0,T.XV)({each:!0}),c("design:type",Array)],v.prototype,"jqlReservedWords",void 0),g([(0,E.Yl)(),c("design:type",Array)],v.prototype,"visibleFieldNames",void 0),g([(0,E.Yl)(),c("design:type",Array)],v.prototype,"visibleFunctionNames",void 0)},41711:(A,S,e)=>{e.d(S,{m:()=>E});class E{constructor(x,p,g,c,v,l,r=!1){this.defaultTagClass=x,this.label=p,this.description=g,this.placeholder=c,this.autocomplete=v,this.validationCallback=l,this.isEmitPossibleOnInvalid=r}validate(x){return!this.validationCallback||this.validationCallback(x)}getDefaultTagClass(){return this.defaultTagClass}getLabel(){return this.label}getPlaceholder(){return this.placeholder}getDescription(){return this.description}getAutocomplete(){return this.autocomplete?this.autocomplete:{begin:()=>{},end:()=>{}}}getEmitPossibleOnInvalid(){return this.isEmitPossibleOnInvalid}}}}]);